var KJUR;if(typeof KJUR=="undefined"||!KJUR)KJUR={};if(typeof KJUR.lang=="undefined"||!KJUR.lang)KJUR.lang={};KJUR.lang.String=function(){};function Base64x(){}function stoBA(s){var a=new Array;for(var i=0;i<s.length;i++){a[i]=s.charCodeAt(i)}return a}function BAtos(a){var s="";for(var i=0;i<a.length;i++){s=s+String.fromCharCode(a[i])}return s}function BAtohex(a){var s="";for(var i=0;i<a.length;i++){var hex1=a[i].toString(16);if(hex1.length==1)hex1="0"+hex1;s=s+hex1}return s}function stohex(s){return BAtohex(stoBA(s))}function stob64(s){return hex2b64(stohex(s))}function stob64u(s){return b64tob64u(hex2b64(stohex(s)))}function b64utos(s){return BAtos(b64toBA(b64utob64(s)))}function b64tob64u(s){s=s.replace(/\=/g,"");s=s.replace(/\+/g,"-");s=s.replace(/\//g,"_");return s}function b64utob64(s){if(s.length%4==2)s=s+"==";else if(s.length%4==3)s=s+"=";s=s.replace(/-/g,"+");s=s.replace(/_/g,"/");return s}function hextob64u(s){if(s.length%2==1)s="0"+s;return b64tob64u(hex2b64(s))}function b64utohex(s){return b64tohex(b64utob64(s))}var utf8tob64u,b64utoutf8;if(typeof Buffer==="function"){utf8tob64u=function(s){return b64tob64u(new Buffer(s,"utf8").toString("base64"))};b64utoutf8=function(s){return new Buffer(b64utob64(s),"base64").toString("utf8")}}else{utf8tob64u=function(s){return hextob64u(uricmptohex(encodeURIComponentAll(s)))};b64utoutf8=function(s){return decodeURIComponent(hextouricmp(b64utohex(s)))}}function utf8tob64(s){return hex2b64(uricmptohex(encodeURIComponentAll(s)))}function b64toutf8(s){return decodeURIComponent(hextouricmp(b64tohex(s)))}function utf8tohex(s){return uricmptohex(encodeURIComponentAll(s))}function hextoutf8(s){return decodeURIComponent(hextouricmp(s))}function hextorstr(sHex){var s="";for(var i=0;i<sHex.length-1;i+=2){s+=String.fromCharCode(parseInt(sHex.substr(i,2),16))}return s}function rstrtohex(s){var result="";for(var i=0;i<s.length;i++){result+=("0"+s.charCodeAt(i).toString(16)).slice(-2)}return result}function hextob64(s){return hex2b64(s)}function hextob64nl(s){var b64=hextob64(s);var b64nl=b64.replace(/(.{64})/g,"$1\r\n");b64nl=b64nl.replace(/\r\n$/,"");return b64nl}function b64nltohex(s){var b64=s.replace(/[^0-9A-Za-z\/+=]*/g,"");var hex=b64tohex(b64);return hex}function hextopem(dataHex,pemHeader){var pemBody=hextob64nl(dataHex);return"-----BEGIN "+pemHeader+"-----\r\n"+pemBody+"\r\n-----END "+pemHeader+"-----\r\n"}function pemtohex(s,sHead){if(s.indexOf("-----BEGIN ")==-1)throw"can't find PEM header: "+sHead;if(sHead!==undefined){s=s.replace("-----BEGIN "+sHead+"-----","");s=s.replace("-----END "+sHead+"-----","")}else{s=s.replace(/-----BEGIN [^-]+-----/,"");s=s.replace(/-----END [^-]+-----/,"")}return b64nltohex(s)}function hextoArrayBuffer(hex){if(hex.length%2!=0)throw"input is not even length";if(hex.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";var buffer=new ArrayBuffer(hex.length/2);var view=new DataView(buffer);for(var i=0;i<hex.length/2;i++){view.setUint8(i,parseInt(hex.substr(i*2,2),16))}return buffer}function ArrayBuffertohex(buffer){var hex="";var view=new DataView(buffer);for(var i=0;i<buffer.byteLength;i++){hex+=("00"+view.getUint8(i).toString(16)).slice(-2)}return hex}function zulutomsec(s){var year,month,day,hour,min,sec,msec,d;var sYear,sFrac,sMsec,matchResult;matchResult=s.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/);if(matchResult){sYear=matchResult[1];year=parseInt(sYear);if(sYear.length===2){if(50<=year&&year<100){year=1900+year}else if(0<=year&&year<50){year=2e3+year}}month=parseInt(matchResult[2])-1;day=parseInt(matchResult[3]);hour=parseInt(matchResult[4]);min=parseInt(matchResult[5]);sec=parseInt(matchResult[6]);msec=0;sFrac=matchResult[7];if(sFrac!==""){sMsec=(sFrac.substr(1)+"00").substr(0,3);msec=parseInt(sMsec)}return Date.UTC(year,month,day,hour,min,sec,msec)}throw"unsupported zulu format: "+s}function zulutosec(s){var msec=zulutomsec(s);return~~(msec/1e3)}function zulutodate(s){return new Date(zulutomsec(s))}function datetozulu(d,flagUTCTime,flagMilli){var s;var year=d.getUTCFullYear();if(flagUTCTime){if(year<1950||2049<year)throw"not proper year for UTCTime: "+year;s=(""+year).slice(-2)}else{s=("000"+year).slice(-4)}s+=("0"+(d.getUTCMonth()+1)).slice(-2);s+=("0"+d.getUTCDate()).slice(-2);s+=("0"+d.getUTCHours()).slice(-2);s+=("0"+d.getUTCMinutes()).slice(-2);s+=("0"+d.getUTCSeconds()).slice(-2);if(flagMilli){var milli=d.getUTCMilliseconds();if(milli!==0){milli=("00"+milli).slice(-3);milli=milli.replace(/0+$/g,"");s+="."+milli}}s+="Z";return s}function uricmptohex(s){return s.replace(/%/g,"")}function hextouricmp(s){return s.replace(/(..)/g,"%$1")}function ipv6tohex(s){var msgMalformedAddress="malformed IPv6 address";if(!s.match(/^[0-9A-Fa-f:]+$/))throw msgMalformedAddress;s=s.toLowerCase();var num_colon=s.split(":").length-1;if(num_colon<2)throw msgMalformedAddress;var colon_replacer=":".repeat(7-num_colon+2);s=s.replace("::",colon_replacer);var a=s.split(":");if(a.length!=8)throw msgMalformedAddress;for(var i=0;i<8;i++){a[i]=("0000"+a[i]).slice(-4)}return a.join("")}function hextoipv6(s){if(!s.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";s=s.toLowerCase();var a=s.match(/.{1,4}/g);for(var i=0;i<8;i++){a[i]=a[i].replace(/^0+/,"");if(a[i]=="")a[i]="0"}s=":"+a.join(":")+":";var aZero=s.match(/:(0:){2,}/g);if(aZero===null)return s.slice(1,-1);var item="";for(var i=0;i<aZero.length;i++){if(aZero[i].length>item.length)item=aZero[i]}s=s.replace(item,"::");return s.slice(1,-1)}function hextoip(s){var malformedMsg="malformed hex value";if(!s.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw malformedMsg;if(s.length==8){var ip;try{ip=parseInt(s.substr(0,2),16)+"."+parseInt(s.substr(2,2),16)+"."+parseInt(s.substr(4,2),16)+"."+parseInt(s.substr(6,2),16);return ip}catch(ex){throw malformedMsg}}else if(s.length==32){return hextoipv6(s)}else{return s}}function iptohex(s){var malformedMsg="malformed IP address";s=s.toLowerCase(s);if(s.match(/^[0-9.]+$/)){var a=s.split(".");if(a.length!==4)throw malformedMsg;var hex="";try{for(var i=0;i<4;i++){var d=parseInt(a[i]);hex+=("0"+d.toString(16)).slice(-2)}return hex}catch(ex){throw malformedMsg}}else if(s.match(/^[0-9a-f:]+$/)&&s.indexOf(":")!==-1){return ipv6tohex(s)}else{throw malformedMsg}}function encodeURIComponentAll(u8){var s=encodeURIComponent(u8);var s2="";for(var i=0;i<s.length;i++){if(s[i]=="%"){s2=s2+s.substr(i,3);i=i+2}else{s2=s2+"%"+stohex(s[i])}}return s2}function newline_toUnix(s){s=s.replace(/\r\n/gm,"\n");return s}function newline_toDos(s){s=s.replace(/\r\n/gm,"\n");s=s.replace(/\n/gm,"\r\n");return s}KJUR.lang.String.isInteger=function(s){if(s.match(/^[0-9]+$/)){return true}else if(s.match(/^-[0-9]+$/)){return true}else{return false}};KJUR.lang.String.isHex=function(s){if(s.length%2==0&&(s.match(/^[0-9a-f]+$/)||s.match(/^[0-9A-F]+$/))){return true}else{return false}};KJUR.lang.String.isBase64=function(s){s=s.replace(/\s+/g,"");if(s.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&s.length%4==0){return true}else{return false}};KJUR.lang.String.isBase64URL=function(s){if(s.match(/[+\/=]/))return false;s=b64utob64(s);return KJUR.lang.String.isBase64(s)};KJUR.lang.String.isIntegerArray=function(s){s=s.replace(/\s+/g,"");if(s.match(/^\[[0-9,]+\]$/)){return true}else{return false}};function hextoposhex(s){if(s.length%2==1)return"0"+s;if(s.substr(0,1)>"7")return"00"+s;return s}function intarystrtohex(s){s=s.replace(/^\s*\[\s*/,"");s=s.replace(/\s*\]\s*$/,"");s=s.replace(/\s*/g,"");try{var hex=s.split(/,/).map(function(element,index,array){var i=parseInt(element);if(i<0||255<i)throw"integer not in range 0-255";var hI=("00"+i.toString(16)).slice(-2);return hI}).join("");return hex}catch(ex){throw"malformed integer array string: "+ex}}var strdiffidx=function(s1,s2){var n=s1.length;if(s1.length>s2.length)n=s2.length;for(var i=0;i<n;i++){if(s1.charCodeAt(i)!=s2.charCodeAt(i))return i}if(s1.length!=s2.length)return n;return-1};